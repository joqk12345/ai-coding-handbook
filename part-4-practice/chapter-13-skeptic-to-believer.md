# 第13章：从怀疑者到信徒 —— 一位AI编码怀疑论者的深度实践

> *"我的职责是交付最好的代码。如果它更好，那就是好代码。"*

## 开篇：怀疑论者的宣言

2025年5月，当大多数人开始狂热追捧AI编码工具时，我成为了一个**坚定的怀疑论者**。

我的立场很明确：
- 生成式LLM可以回答快速问题
- 但**智能体（agents）**？不可靠、昂贵、炒作远大于实际表现
- 如果你给我看一个足够稳定的智能体，我会改变立场

这不是固执，而是一种**工程严谨性**——在亲眼验证之前，拒绝接受任何未经证实的声明。

## 早期探索：失望的开端

### GitHub Copilot + Claude Sonnet 4.5 的测试

我的第一次尝试是使用 GitHub Copilot 配合 Claude Sonnet 4.5 来辅助数据科学工作。

**结果令人失望：**
- 生成的 Jupyter 笔记本冗长且无用
- 代码质量参差不齐
- 需要大量人工修正

**唯一的亮点：**
使用 LLM 改进了我的开源项目 `gemimg`，添加了文档字符串和类型注解。有用，但远未达到"革命性"。

## 转折点：AGENTS.md 的发现

### 关键的洞察

真正的突破来自于一个被大多数人忽视的细节：**AGENTS.md 文件**。

这不是一个风格指南，而是一个**系统提示（system prompt）**——它决定了智能体的行为模式。

### 创建完美的 AGENTS.md

我为 Python 项目创建了一个极其详尽的 AGENTS.md，包含强制规则：

```markdown
# AGENTS.md - Python Project Standards

## 必须遵守的规则

### 工具和环境
- MUST 使用 `uv` 进行包管理
- MUST 使用 `.venv` 作为虚拟环境
- MUST 使用 `polars` 替代 `pandas`

### 代码风格
- NEVER 使用表情符号（✓, ✗）
- MUST 避免冗余注释
- MUST 使用类型注解

### 测试
- MUST 编写 pytest 测试
- MUST 达到 80% 覆盖率
```

### 结果：质的飞跃

**遵守程度：** Opus 4.5 **完全遵守所有规则**。

**对比实验：**
- **有 AGENTS.md：** 代码质量高，一致性强
- **无 AGENTS.md：** 输出质量立即崩塌

**关键洞察：**
> AGENTS.md 不是风格指南，而是代理的行为系统提示。

## 深度实践：四个Rust项目的挑战

### 为什么选择 Rust？

OpenAI 高管 Greg Brockman 的话引起了我的注意：

> "Rust 是代理的完美语言，因为编译通过 ≈ 基本正确。"

我决定让 Opus 4.5 用 Rust 完成四个高难度项目，**每个都带 Python 绑定**，验证 AI 是否能真正"超越人类"。

---

### 项目 1：icon-to-image

**目标：** 用 Rust 从 Font Awesome 字体文件渲染图标为 PNG/WEBP，支持透明背景、颜色控制、超采样，并提供 Python 接口。

**提示包含 10+ 条约束：**
- 用 `fontdue` 渲染
- 支持 2x 超采样
- 写 pytest 测试

**结果：**
- 代理**一次完成**，Python 接口直接可用
- 后发现 `fontdue` 渲染曲线锯齿 → 代理**主动搜索** → 改用 `ab_glyph` → 问题解决

**关键洞察：**
AI 不仅能执行指令，还能**主动发现问题并解决**。

---

### 项目 2：word-clouds

**目标：** 构建一个无需 JavaScript 框架的交互式 Web 应用，生成词云。

**技术栈：**
- FastAPI + HTMX + PicoCSS

**过程：**
1. 第一次：用 Pico CSS + 原生 JS → 成功
2. 第二次：上传 shadcn/ui 截图，要求"照着这个风格做" → 代理**完美复现 UI**

**结果：**
- 自动生成带 YouTube 风格缩略图的播放器
- 无需复杂 JavaScript 框架

**关键洞察：**
> AI 可以"看懂"设计图并实现，设计前端的能力已经超越了许多人类开发者。

---

### 项目 3：miditui

**目标：** 在终端中实现一个 MIDI 作曲与播放器，用 `rodio` 播放音频，`ratatui` 绘制 UI。

**挑战：**
- 代理**无法看到终端输出**
- 需要理解 `ratatui` 的交互逻辑

**过程：**
- 作者扮演 QA：报告"点击播放无反应"、"滚动后点击错位"
- 代理**每次都能修复**

**结果：**
- 功能完整的终端 MIDI 播放器
- 支持实时交互

**关键洞察：**
> AI 虽然"盲"，但只要懂框架，就能写对交互逻辑。人类也常犯这类 UI 错误。

---

### 项目 4：ballin

**目标：** 用 Rust 实现一个终端物理模拟器，模拟 **10,000+ 个弹球**。

**技术栈：**
- `rapier` 物理引擎
- Braille Unicode 字符呈现超高细节

**过程：**
- 代理**一次完成**
- 支持颜色按钮每个字母不同色
- 升级 `rapier` 至 0.32 版导致崩溃

**挑战：**
- 代理无法调试（无运行环境）
- 作者手动回退至 0.31 版

**结果：**
- 稳定运行 10,000+ 弹球
- 无需 GPU

**关键洞察：**
> AI 需要人类做"运行+调试"环节。但编码本身，AI 已经超越大多数人类。

---

## 性能战争：智能体优化

### 基准测试

作者不再满足于"能用"，追求"最快"。

他测试 GPT-5.3-Codex 和 Opus 4.6 优化 **UMAP、HDBSCAN、GBDT** 等机器学习算法。

**八步优化流程：**
1. 实现算法
2. 清理代码
3. 找瓶颈
4. 目标提速 60%
5. 用火焰图调并行
6. 加 PyO3 绑定
7. 对比 Python
8. 强制输出与标准实现一致（防作弊）

**结果：**

| 算法 | 对比 Python | 对比 Rust 原版 |
|------|-------------|----------------|
| UMAP | 快 9–30 倍 | 快 2–10 倍 |
| HDBSCAN | 快 3–10 倍 | 快 100 倍 |
| GBDT | 快 24 倍（训练） | - |

**关键洞察：**
> 所有代码运行在 Apple Silicon Metal 上，无需 CUDA。

---

## 终极测试：`nndex` 向量搜索库

### 目标

构建一个极致快速的**向量最近邻搜索库**。

### 挑战

NumPy 已用 BLAS 高度优化。

### 结果

- 代理实现后，**与 NumPy 性能持平**
- 加入 BLAS 支持后，**单查询快 1–5 倍**，批量查询更快
- GPU 支持测试失败：低于 10 万行时，GPU 调度开销 > 计算收益

### 关键洞察

> **关键证明**：比现有库更快 → **代码不可能是复制的** → 必然为原创优化。

---

## 行业启示：编程的未来

### 核心结论

1. **个人速度 ≠ 组织速度**
   - 投资于编码智能体而不解决周围系统，只会加深虚假顶峰

2. **localhost 成为瓶颈**
   - 专业工程需要后台、安全、规模化的智能体执行

3. **三步路径**：建立原语 → 找到瓶颈 → 扩展工厂

### 关键建议

> **如果你 2025 年之前试过 AI 代理失败，现在再试一次！**

用你自己的 AGENTS.md —— 严格的规则带来质的飞跃。

### 最后的思考

> "我对 AI 讨论的现状感到悲伤，但对它的潜力充满兴奋。目前，我还不知道哪种情绪更强。"

---

## 参考资源

- **Advent of Claude 2025**: [adocomplete.com](https://adocomplete.com/advent-of-claude-2025/)
- **Learn Claude Code**: [GitHub](https://github.com/shareAI-lab/learn-claude-code)
- **Background Agents**: [background-agents.com](https://background-agents.com/)
- **Opus 4.5 深度实践**: [原文链接](https://gist.github.com/gwern/...)